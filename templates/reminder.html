{% extends "base.html" %}

{% block content %}
<div id="reminderBox" style="max-width: 500px; margin: 30px auto; padding: 25px; background-color: #f7f9fc; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); font-family: 'Arial', sans-serif; opacity:0; transform: translateY(20px); transition: all 0.5s ease;">
    <h2 style="text-align:center; color: #333;">ðŸ’¡ Health Reminder</h2>
    <p style="text-align:center; color: #666; margin-bottom: 20px;">Set your reminders to stay healthy and active!</p>

    <div style="margin-bottom: 15px;">
        <label style="font-weight: 600; color: #555;">Reminder Type:</label><br>
        <select id="reminderType" style="width:100%; padding:10px; border-radius: 8px; border:1px solid #ccc; margin-top:5px;">
            <option value="">Select</option>
            <option value="medicine">Medicine</option>
            <option value="exercise">Exercise</option>
            <option value="water">Drink Water</option>
        </select>
    </div>

    <div style="margin-bottom: 15px;">
        <label style="font-weight: 600; color: #555;">Reminder Time:</label><br>
        <input type="time" id="reminderTime" style="width:95%; padding:10px; border-radius:8px; border:1px solid #ccc; margin-top:5px;">
    </div>

    <div style="margin-bottom: 15px;">
        <label style="font-weight: 600; color: #555;">Email:</label><br>
        <input type="email" id="email" placeholder="example@gmail.com" style="width:95%; padding:10px; border-radius:8px; border:1px solid #ccc; margin-top:5px;">
    </div>

    <div style="margin-bottom: 20px;">
        <label style="font-weight: 600; color: #555;">Mobile Number:</label><br>
        <input type="text" id="phone" placeholder="+91XXXXXXXXXX" style="width:95%; padding:10px; border-radius:8px; border:1px solid #ccc; margin-top:5px;">
    </div>

    <button type="button" onclick="saveReminder()" 
    style="width:100%; padding:12px; border:none; border-radius:8px; background: linear-gradient(135deg,#a18cd1,#fbc2eb); color:white; font-weight:600; font-size:16px; cursor:pointer; transition: all 0.25s ease; box-shadow:0 6px 14px rgba(0,0,0,0.15);"
    onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 18px rgba(0,0,0,0.25)';"
    onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 14px rgba(0,0,0,0.15)';"
    onmousedown="this.style.transform='scale(0.96)';"
    onmouseup="this.style.transform='translateY(-3px)';">Save Reminder</button>

    <p id="reminderMsg" style="margin-top:15px; text-align:center; font-weight:500;"></p>
</div>

<!-- ðŸ”¹ VIEW HISTORY BUTTON (BELOW BOX) -->
<a href="{{ url_for('reminder_history') }}"
   style="display:block; margin:20px auto; text-align:center;
          padding:10px 18px; background: linear-gradient(135deg,#4facfe,#00c6ff); color:white;
          border-radius:8px; text-decoration:none; width:220px;
          box-shadow:0 6px 14px rgba(0,0,0,0.15); transition: all 0.25s ease;"
   onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 18px rgba(0,0,0,0.25)';"
   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 14px rgba(0,0,0,0.15)';"
   onmousedown="this.style.transform='scale(0.96)';"
   onmouseup="this.style.transform='translateY(-3px)';"
>
   ðŸ“œ View Reminder History
</a>

<script>
window.addEventListener('DOMContentLoaded', () => {
    const box = document.getElementById('reminderBox');
    // Animate in like a pop-up
    setTimeout(() => {
        box.style.opacity = '1';
        box.style.transform = 'translateY(0)';
    }, 100); // slight delay for smoother effect
});

function saveReminder() {
    const type = document.getElementById("reminderType").value;
    const time = document.getElementById("reminderTime").value;
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    const msg = document.getElementById("reminderMsg");

    if (!type || !time || !email) {
    msg.style.color = "red";
    msg.innerText = "Please fill reminder type, time, and email";
    return;
    }

    fetch("/save-reminder", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ type, time, email, phone })
    })
    .then(res => res.json())
    .then(data => {
        let [hour, minute] = time.split(":").map(Number);
        let period = "AM";
        if (hour >= 12) {
            period = "PM";
            if (hour > 12) hour -= 12;
        }
        if (hour === 0) hour = 12;

        const formattedTime = `${hour}:${minute.toString().padStart(2, "0")} ${period}`;
        msg.style.color = "green";
        msg.innerText = `${type.charAt(0).toUpperCase() + type.slice(1)} reminder set for ${formattedTime}`;
    })
    .catch(() => {
        msg.style.color = "red";
        msg.innerText = "Error saving reminder";
    });
}
</script>
{% endblock %}
